#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö 50 —Ä–∞–∑–Ω—ã–º–∏ –∫–Ω–∏–≥–∞–º–∏ —Å –∞–≤—Ç–æ—Ä–∞–º–∏ –∏ –∂–∞–Ω—Ä–∞–º–∏
–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å SQLAdmin –∏ async engine
"""

import asyncio
from sqlalchemy.ext.asyncio import AsyncSession
from sqlalchemy import select
from app.models.authors import AuthorsModel
from app.models.gengres import GengresModel
from app.models.books import BooksModel
from app.database.async_db import async_engine, AsyncSessionLocal, Base

# –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–æ–≤
AUTHORS = [
    "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π",
    "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π",
    "–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤",
    "–ò–≤–∞–Ω –¢—É—Ä–≥–µ–Ω–µ–≤",
    "–ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤",
    "–ú–∞–∫—Å–∏–º –ì–æ—Ä—å–∫–∏–π",
    "–ù–∏–∫–æ–ª–∞–π –ì–æ–≥–æ–ª—å",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü—É—à–∫–∏–Ω",
    "–ú–∏—Ö–∞–∏–ª –õ–µ—Ä–º–æ–Ω—Ç–æ–≤",
    "–ò–≤–∞–Ω –ì–æ–Ω—á–∞—Ä–æ–≤",
    "–ë–æ—Ä–∏—Å –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫",
    "–í–ª–∞–¥–∏–º–∏—Ä –ú–∞—è–∫–æ–≤—Å–∫–∏–π",
    "–°–µ—Ä–≥–µ–π –ï—Å–µ–Ω–∏–Ω",
    "–ú–∞—Ä–∏–Ω–∞ –¶–≤–µ—Ç–∞–µ–≤–∞",
    "–ê–Ω–Ω–∞ –ê—Ö–º–∞—Ç–æ–≤–∞",
    "–û—Å–∏–ø –ú–∞–Ω–¥–µ–ª—å—à—Ç–∞–º",
    "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –ü–∞—É—Å—Ç–æ–≤—Å–∫–∏–π",
    "–í–∏–∫—Ç–æ—Ä –ê—Å—Ç–∞—Ñ—å–µ–≤",
    "–í–∞–ª–µ–Ω—Ç–∏–Ω –†–∞—Å–ø—É—Ç–∏–Ω",
    "–ò–≤–∞–Ω –ë—É–Ω–∏–Ω",
    "–ê–Ω–¥—Ä–µ–π –ë–µ–ª—ã–π",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ö—É–ø—Ä–∏–Ω",
    "–ü–∞–≤–µ–ª –ö–æ—ç–ª—å–æ",
    "–î–º–∏—Ç—Ä–∏–π –ú–µ—Ä–µ–∂–∫–æ–≤—Å–∫–∏–π",
    "–ú–∏—Ö–∞–∏–ª –®–æ–ª–æ—Ö–æ–≤",
    "–ê—Ä—Ç—É—Ä –ö–æ–Ω–∞–Ω –î–æ–π–ª",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°—É–º–∞—Ä–æ–∫–æ–≤",
    "–î–∂–æ–∞–Ω –†–æ—É–ª–∏–Ω–≥",
    "–®–∞—Ä–ª–æ—Ç—Ç–∞ –ë—Ä–æ–Ω—Ç–µ",
    "–î–∂–µ–π–Ω –û—Å—Ç–∏–Ω",
    "–û—Å–∫–∞—Ä –£–∞–π–ª—å–¥",
    "–ú—ç—Ä–∏ –®–µ–ª–ª–∏",
    "–ë—Ä—ç–º –°—Ç–æ–∫–µ—Ä",
    "–ì–µ—Ä–±–µ—Ä—Ç –£—ç–ª–ª—Å",
    "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª",
    "–û–ª–¥–æ—Å –•–∞–∫—Å–ª–∏",
    "–†–µ–π –ë—Ä—ç–¥–±–µ—Ä–∏",
    "–ê–Ω—Ç—É–∞–Ω –¥–µ –°–µ–Ω—Ç-–≠–∫–∑—é–ø–µ—Ä–∏",
    "–õ—å—é–∏—Å –ö—ç—Ä—Ä–æ–ª–ª",
    "–ù–∏–∫–æ–ª–∞–π –ù–æ—Å–æ–≤",
    "–î–∂–µ—Ä–æ–º –°—ç–ª–∏–Ω–¥–∂–µ—Ä",
    "–¢—Ä—É–º–µ–Ω –ö–∞–ø–æ—Ç–µ",
    "–õ–∞–π–º–∞–Ω –§—Ä—ç–Ω–∫ –ë–∞—É–º",
    "–†–æ–±–µ—Ä—Ç –õ—å—é–∏—Å –°—Ç–∏–≤–µ–Ω—Å–æ–Ω",
    "–£–∏–ª—å—è–º –ì–æ–ª–¥–∏–Ω–≥",
    "–ó–∞—Ö–∞—Ä –ì–∞–≤—Ä–∏–ª–µ–Ω–∫–æ",
    "–†–∏—á–∞—Ä–¥ –ê–¥–∞–º—Å",
    "–í–ª–∞–¥–∏–º–∏—Ä –ú–µ–Ω—å—à–æ–≤",
    "–ñ—é–ª—å –í–µ—Ä–Ω",
    "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ö–∞–∑–∞–Ω—Ü–µ–≤",
    "–ò–≤–∞–Ω –ï—Ñ—Ä–µ–º–æ–≤"
]

# –°–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤
GENRES = [
    "–†–æ–º–∞–Ω",
    "–î–µ—Ç–µ–∫—Ç–∏–≤",
    "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞",
    "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞",
    "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è",
    "–î—Ä–∞–º–∞",
    "–ö–æ–º–µ–¥–∏—è",
    "–¢—Ä–∏–ª–ª–µ—Ä",
    "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∑–∞",
    "–õ—é–±–æ–≤–Ω—ã–π —Ä–æ–º–∞–Ω",
    "–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π —Ä–æ–º–∞–Ω"
]

async def populate_database():
    """
    –ó–∞–ø–æ–ª–Ω—è–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∞–≤—Ç–æ—Ä–∞–º–∏, –∂–∞–Ω—Ä–∞–º–∏ –∏ –∫–Ω–∏–≥–∞–º–∏ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
    """
    # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
    async with async_engine.begin() as conn:
        await conn.run_sync(Base.metadata.create_all)
    
    async with AsyncSessionLocal() as session:
        try:
            # –î–æ–±–∞–≤–ª—è–µ–º –∂–∞–Ω—Ä—ã
            print("\nüìö –î–æ–±–∞–≤–ª—è—é –∂–∞–Ω—Ä—ã...")
            genres_dict = {}
            for genre_name in GENRES:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ
                result = await session.execute(
                    select(GengresModel).where(GengresModel.name == genre_name)
                )
                existing = result.scalars().first()
                
                if not existing:
                    genre = GengresModel(name=genre_name)
                    session.add(genre)
                    await session.flush()
                    genres_dict[genre_name] = genre
                else:
                    genres_dict[genre_name] = existing
            
            await session.commit()
            print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(GENRES)} –∂–∞–Ω—Ä–æ–≤")
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∞–≤—Ç–æ—Ä–æ–≤
            print("\nüë§ –î–æ–±–∞–≤–ª—è—é –∞–≤—Ç–æ—Ä–æ–≤...")
            authors_dict = {}
            for author_name in AUTHORS:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ
                result = await session.execute(
                    select(AuthorsModel).where(AuthorsModel.name == author_name)
                )
                existing = result.scalars().first()
                
                if not existing:
                    author = AuthorsModel(name=author_name)
                    session.add(author)
                    await session.flush()
                    authors_dict[author_name] = author
                else:
                    authors_dict[author_name] = existing
            
            await session.commit()
            print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(AUTHORS)} –∞–≤—Ç–æ—Ä–æ–≤")
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–∏–≥–∏
            print("\nüìñ –î–æ–±–∞–≤–ª—è—é 50 –∫–Ω–∏–≥...")
            books_data = [
                ("–í–æ–π–Ω–∞ –∏ –º–∏—Ä", "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π", "–†–æ–º–∞–Ω", 1869, "–≠–ø–∏—á–µ—Å–∫–æ–µ –ø–æ–ª–æ—Ç–Ω–æ –∂–∏–∑–Ω–∏ –∏ —Å–º–µ—Ä—Ç–∏, –≤–æ–π–Ω—ã –∏ –º–∏—Ä–∞."),
                ("–ü—Ä–µ—Å—Ç—É–ø–ª–µ–Ω–∏–µ –∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ", "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–†–æ–º–∞–Ω", 1866, "–≠—Ç–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏—Å—Å–ª–µ–¥—É–µ—Ç –≥–ª—É–±–∏–Ω—ã —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–π –ø—Å–∏—Ö–∏–∫–∏ –∏ –º–æ—Ä–∞–ª–∏."),
                ("–ú–∞—Å—Ç–µ—Ä –∏ –ú–∞—Ä–≥–∞—Ä–∏—Ç–∞", "–ú–∏—Ö–∞–∏–ª –ë—É–ª–≥–∞–∫–æ–≤", "–†–æ–º–∞–Ω", 1967, "–ö–ª–∞—Å—Å–∏–∫–∞ –º–∏—Ä–æ–≤–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã, –∫–æ—Ç–æ—Ä–∞—è —Å—Ç–æ–∏—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å –∫–∞–∂–¥–æ–º—É."),
                ("–ò–¥–∏–æ—Ç", "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–†–æ–º–∞–Ω", 1869, "–ò—Å—Ç–æ—Ä–∏—è —á–µ–ª–æ–≤–µ–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –æ—Å—Ç–∞–µ—Ç—Å—è –≤–µ—Ä–µ–Ω —Å–≤–æ–∏–º –ø—Ä–∏–Ω—Ü–∏–ø–∞–º."),
                ("–î–≤–æ—Ä—è–Ω—Å–∫–æ–µ –≥–Ω–µ–∑–¥–æ", "–ò–≤–∞–Ω –¢—É—Ä–≥–µ–Ω–µ–≤", "–†–æ–º–∞–Ω", 1859, "–ò—Å—Ç–æ—Ä–∏—è –ª—é–±–≤–∏ –∏ —Å—É–¥—å–±—ã –≤ –†–æ—Å—Å–∏–∏ XIX –≤–µ–∫–∞."),
                ("–û—Ç—Ü—ã –∏ –¥–µ—Ç–∏", "–ò–≤–∞–Ω –¢—É—Ä–≥–µ–Ω–µ–≤", "–†–æ–º–∞–Ω", 1862, "–°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ –ø–æ–∫–æ–ª–µ–Ω–∏–π –∏ –∏–¥–µ–π."),
                ("–ú–µ—Ä—Ç–≤—ã–µ –¥—É—à–∏", "–ù–∏–∫–æ–ª–∞–π –ì–æ–≥–æ–ª—å", "–†–æ–º–∞–Ω", 1842, "–°–∞—Ç–∏—Ä–∞ –Ω–∞ —Ä—É—Å—Å–∫—É—é –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å."),
                ("–ï–≤–≥–µ–Ω–∏–π –û–Ω–µ–≥–∏–Ω", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü—É—à–∫–∏–Ω", "–†–æ–º–∞–Ω", 1833, "–ò—Å—Ç–æ—Ä–∏—è –ª—é–±–≤–∏ –∏ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏—è."),
                ("–ì–µ—Ä–æ–π –Ω–∞—à–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏", "–ú–∏—Ö–∞–∏–ª –õ–µ—Ä–º–æ–Ω—Ç–æ–≤", "–†–æ–º–∞–Ω", 1840, "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—Ç—Ä–µ—Ç –º–æ–ª–æ–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞."),
                ("–û–±–ª–æ–º–æ–≤", "–ò–≤–∞–Ω –ì–æ–Ω—á–∞—Ä–æ–≤", "–†–æ–º–∞–Ω", 1859, "–ò—Å—Ç–æ—Ä–∏—è –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è –∏ –ø–∞—Å—Å–∏–≤–Ω–æ—Å—Ç–∏."),
                ("–ë–µ—Å—ã", "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–†–æ–º–∞–Ω", 1872, "–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π —Ä–æ–º–∞–Ω –æ —Ä–µ–≤–æ–ª—é—Ü–∏–∏."),
                ("–ê–Ω–Ω–∞ –ö–∞—Ä–µ–Ω–∏–Ω–∞", "–õ–µ–≤ –¢–æ–ª—Å—Ç–æ–π", "–†–æ–º–∞–Ω", 1877, "–ò—Å—Ç–æ—Ä–∏—è –ª—é–±–≤–∏ –∏ –∏–∑–º–µ–Ω—ã."),
                ("–î–æ–∫—Ç–æ—Ä –ñ–∏–≤–∞–≥–æ", "–ë–æ—Ä–∏—Å –ü–∞—Å—Ç–µ—Ä–Ω–∞–∫", "–†–æ–º–∞–Ω", 1957, "–†–æ–º–∞–Ω –æ —Ä–µ–≤–æ–ª—é—Ü–∏–∏ –∏ –ª—é–±–≤–∏."),
                ("–¢–∏—Ö–∏–π –î–æ–Ω", "–ú–∏—Ö–∞–∏–ª –®–æ–ª–æ—Ö–æ–≤", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∑–∞", 1928, "–≠–ø–æ—Å –æ –∫–∞–∑–∞—á–µ—Å—Ç–≤–µ –∏ –ì—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–π –≤–æ–π–Ω–µ."),
                ("–®–µ—Ä–ª–æ–∫ –•–æ–ª–º—Å", "–ê—Ä—Ç—É—Ä –ö–æ–Ω–∞–Ω –î–æ–π–ª", "–î–µ—Ç–µ–∫—Ç–∏–≤", 1892, "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤–µ–ª–∏–∫–æ–≥–æ —Å—ã—â–∏–∫–∞."),
                ("–ì—Ä–∞—Ñ –ú–æ–Ω—Ç–µ-–ö—Ä–∏—Å—Ç–æ", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1844, "–ò—Å—Ç–æ—Ä–∏—è –º–µ—Å—Ç–∏ –∏ –∏—Å–∫—É–ø–ª–µ–Ω–∏—è."),
                ("–¢—Ä–∏ –º—É—à–∫–µ—Ç–µ—Ä–∞", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –î—é–º–∞", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1844, "–ó–∞—Ö–≤–∞—Ç—ã–≤–∞—é—â–∏–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è –≤–æ –§—Ä–∞–Ω—Ü–∏–∏."),
                ("–•—Ä–æ–º–æ–π –±–∞—Ä–∏–Ω", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –°—É–º–∞—Ä–æ–∫–æ–≤", "–î—Ä–∞–º–∞", 1739, "–ü–µ—Ä–≤–∞—è —Ä—É—Å—Å–∫–∞—è –∫–æ–º–µ–¥–∏—è."),
                ("–ë–µ–ª—ã–µ –Ω–æ—á–∏", "–§–µ–¥–æ—Ä –î–æ—Å—Ç–æ–µ–≤—Å–∫–∏–π", "–î—Ä–∞–º–∞", 1848, "–ì—Ä—É—Å—Ç–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–∞."),
                ("–ü–æ–≤–µ—Å—Ç–∏ –ë–µ–ª–∫–∏–Ω–∞", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü—É—à–∫–∏–Ω", "–î—Ä–∞–º–∞", 1831, "–°–±–æ—Ä–Ω–∏–∫ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∏—Å—Ç–æ—Ä–∏–π –æ –∂–∏–∑–Ω–∏."),
                ("–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä –∏ —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π –∫–∞–º–µ–Ω—å", "–î–∂–æ–∞–Ω –†–æ—É–ª–∏–Ω–≥", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1997, "–í–æ–ª—à–µ–±–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –º–æ–ª–æ–¥–æ–≥–æ –≤–æ–ª—à–µ–±–Ω–∏–∫–∞."),
                ("–î–∂–µ–π–Ω –≠–π—Ä", "–®–∞—Ä–ª–æ—Ç—Ç–∞ –ë—Ä–æ–Ω—Ç–µ", "–†–æ–º–∞–Ω", 1847, "–ò—Å—Ç–æ—Ä–∏—è –æ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ–π –∏ —Å–∏–ª—å–Ω–æ–π –∂–µ–Ω—â–∏–Ω–µ."),
                ("–ì–æ—Ä–¥–æ—Å—Ç—å –∏ –ø—Ä–µ–¥—É–±–µ–∂–¥–µ–Ω–∏–µ", "–î–∂–µ–π–Ω –û—Å—Ç–∏–Ω", "–õ—é–±–æ–≤–Ω—ã–π —Ä–æ–º–∞–Ω", 1813, "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ä–æ–º–∞–Ω –æ –ª—é–±–≤–∏ –∏ –¥–æ–ª–≥–µ."),
                ("–ü–æ—Ä—Ç—Ä–µ—Ç –î–æ—Ä–∏–∞–Ω–∞ –ì—Ä–µ—è", "–û—Å–∫–∞—Ä –£–∞–π–ª—å–¥", "–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∏–π —Ä–æ–º–∞–Ω", 1890, "–ò—Å—Ç–æ—Ä–∏—è –æ –∫—Ä–∞—Å–æ—Ç–µ –∏ —Ä–∞–∑–≤—Ä–∞—â–µ–Ω–∏–∏."),
                ("–§—Ä–∞–Ω–∫–µ–Ω—à—Ç–µ–π–Ω", "–ú—ç—Ä–∏ –®–µ–ª–ª–∏", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1818, "–ò—Å—Ç–æ—Ä–∏—è –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∏ —Ä–∞–∑—Ä—É—à–µ–Ω–∏–∏."),
                ("–î—Ä–∞–∫—É–ª–∞", "–ë—Ä—ç–º –°—Ç–æ–∫–µ—Ä", "–¢—Ä–∏–ª–ª–µ—Ä", 1897, "–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –≤–∞–º–ø–∏—Ä—Å–∫–∏–π —Ä–æ–º–∞–Ω."),
                ("–ú–∞—à–∏–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏", "–ì–µ—Ä–±–µ—Ä—Ç –£—ç–ª–ª—Å", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1895, "–ü—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –≤ –±—É–¥—É—â–µ–µ –∏ –ø—Ä–æ—à–ª–æ–µ."),
                ("1984", "–î–∂–æ—Ä–¥–∂ –û—Ä—É—ç–ª–ª", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1949, "–ê–Ω—Ç–∏—É—Ç–æ–ø–∏—è –æ —Ç–æ—Ç–∞–ª–∏—Ç–∞—Ä–Ω–æ–º –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ."),
                ("–û –¥–∏–≤–Ω—ã–π –Ω–æ–≤—ã–π –º–∏—Ä", "–û–ª–¥–æ—Å –•–∞–∫—Å–ª–∏", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1932, "–£—Ç–æ–ø–∏—è –±—É–¥—É—â–µ–≥–æ –∏ –µ–≥–æ –ø—Ä–æ–±–ª–µ–º—ã."),
                ("451 –≥—Ä–∞–¥—É—Å –ø–æ –§–∞—Ä–µ–Ω–≥–µ–π—Ç—É", "–†–µ–π –ë—Ä—ç–¥–±–µ—Ä–∏", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1953, "–ò—Å—Ç–æ—Ä–∏—è –æ –∫–Ω–∏–≥–∞—Ö –∏ –∑–∞–ø—Ä–µ—Ç–∞—Ö."),
                ("–ú–∞–ª–µ–Ω—å–∫–∏–π –ø—Ä–∏–Ω—Ü", "–ê–Ω—Ç—É–∞–Ω –¥–µ –°–µ–Ω—Ç-–≠–∫–∑—é–ø–µ—Ä–∏", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1943, "–§–∏–ª–æ—Å–æ—Ñ—Å–∫–∞—è —Å–∫–∞–∑–∫–∞ –æ –∂–∏–∑–Ω–∏ –∏ –ª—é–±–≤–∏."),
                ("–ê–ª–∏—Å–∞ –≤ —Å—Ç—Ä–∞–Ω–µ —á—É–¥–µ—Å", "–õ—å—é–∏—Å –ö—ç—Ä—Ä–æ–ª–ª", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1865, "–í–æ–ª—à–µ–±–Ω–æ–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ –¥–µ–≤–æ—á–∫–∏."),
                ("–í–∏–Ω—Ç–∏–∫ –∏ –®–ø—É–Ω—Ç–∏–∫", "–ù–∏–∫–æ–ª–∞–π –ù–æ—Å–æ–≤", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1958, "–ò—Å—Ç–æ—Ä–∏—è –æ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è—Ö –≤–µ—Å–µ–ª—ã—Ö –∫–æ—Ä–æ—Ç—ã—à–µ–∫."),
                ("–ù–∞–¥ –ø—Ä–æ–ø–∞—Å—Ç—å—é –≤–æ —Ä–∂–∏", "–î–∂–µ—Ä–æ–º –°—ç–ª–∏–Ω–¥–∂–µ—Ä", "–†–æ–º–∞–Ω", 1951, "–ò—Å—Ç–æ—Ä–∏—è –ø–æ–¥—Ä–æ—Å—Ç–∫–∞ –≤ –±–æ–ª—å—à–æ–º –≥–æ—Ä–æ–¥–µ."),
                ("–ó–∞–≤—Ç—Ä–∞–∫ —É –¢–∏—Ñ—Ñ–∞–Ω–∏", "–¢—Ä—É–º–µ–Ω –ö–∞–ø–æ—Ç–µ", "–†–æ–º–∞–Ω", 1958, "–ò—Å—Ç–æ—Ä–∏—è –æ –∫—Ä–∞—Å–∏–≤–æ–π –∂–µ–Ω—â–∏–Ω–µ –≤ –ù—å—é-–ô–æ—Ä–∫–µ."),
                ("–í–æ–ª—à–µ–±–Ω–∏–∫ –∏–∑ –°—Ç—Ä–∞–Ω—ã –û–∑", "–õ–∞–π–º–∞–Ω –§—Ä—ç–Ω–∫ –ë–∞—É–º", "–§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1900, "–í–æ–ª—à–µ–±–Ω–æ–µ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –¥–µ–≤–æ—á–∫–∏ –î–æ—Ä–æ—Ç–∏."),
                ("–û—Å—Ç—Ä–æ–≤ —Å–æ–∫—Ä–æ–≤–∏—â", "–†–æ–±–µ—Ä—Ç –õ—å—é–∏—Å –°—Ç–∏–≤–µ–Ω—Å–æ–Ω", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1882, "–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∏—Å–∫–æ–≤ –ø–∏—Ä–∞—Ç—Å–∫–æ–≥–æ –∫–ª–∞–¥–∞."),
                ("–ü–æ–≤–µ–ª–∏—Ç–µ–ª—å –º—É—Ö", "–£–∏–ª—å—è–º –ì–æ–ª–¥–∏–Ω–≥", "–¢—Ä–∏–ª–ª–µ—Ä", 1954, "–ò—Å—Ç–æ—Ä–∏—è –æ –º–∞–ª—å—á–∏–∫–∞—Ö –Ω–∞ –Ω–µ–æ–±–∏—Ç–∞–µ–º–æ–º –æ—Å—Ç—Ä–æ–≤–µ."),
                ("–í–æ–π–Ω–∞ –º–∏—Ä–æ–≤", "–ì–µ—Ä–±–µ—Ä—Ç –£—ç–ª–ª—Å", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1898, "–í—Ç–æ—Ä–∂–µ–Ω–∏–µ –º–∞—Ä—Å–∏–∞–Ω –Ω–∞ –ó–µ–º–ª—é."),
                ("–ó–∞–ø–∏—Å–∫–∏ –æ—Ö–æ—Ç–Ω–∏–∫–∞", "–ò–≤–∞–Ω –¢—É—Ä–≥–µ–Ω–µ–≤", "–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–∑–∞", 1852, "–û—á–µ—Ä–∫–∏ –∂–∏–∑–Ω–∏ —Ä—É—Å—Å–∫–æ–≥–æ –Ω–∞—Ä–æ–¥–∞."),
                ("–ë–µ–∂–∏–Ω –ª—É–≥", "–ò–≤–∞–Ω –¢—É—Ä–≥–µ–Ω–µ–≤", "–î—Ä–∞–º–∞", 1851, "–ò—Å—Ç–æ—Ä–∏—è –æ—Ö–æ—Ç–Ω–∏–∫–∞ –∏ –¥–µ—Ç–µ–π."),
                ("–ü—è—Ç–Ω–∞–¥—Ü–∞—Ç—å", "–ó–∞—Ö–∞—Ä –ì–∞–≤—Ä–∏–ª–µ–Ω–∫–æ", "–î–µ—Ç–µ–∫—Ç–∏–≤", 2000, "–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –¥–µ—Ç–µ–∫—Ç–∏–≤–Ω—ã–π —Ä–æ–º–∞–Ω."),
                ("–ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–æ –∂–∏–≤–æ—Ç–Ω—ã—Ö", "–†–∏—á–∞—Ä–¥ –ê–¥–∞–º—Å", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1972, "–ò—Å—Ç–æ—Ä–∏—è –∫—Ä–æ–ª–∏–∫–æ–≤ –≤ –ø–æ–∏—Å–∫–µ –Ω–æ–≤–æ–≥–æ –¥–æ–º–∞."),
                ("–û—Å—Ç—Ä–æ–≤ –¥–æ–∫—Ç–æ—Ä–∞ –ú–æ—Ä–æ", "–ì–µ—Ä–±–µ—Ä—Ç –£—ç–ª–ª—Å", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1896, "–ò—Å—Ç–æ—Ä–∏—è —É–∂–∞—Å–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞."),
                ("–õ—é–±–æ–≤—å –∏ –≥–æ–ª—É–±–∏", "–í–ª–∞–¥–∏–º–∏—Ä –ú–µ–Ω—å—à–æ–≤", "–ö–æ–º–µ–¥–∏—è", 1984, "–°–º–µ—à–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –æ —Å–µ–º–µ–π–Ω–æ–π –∂–∏–∑–Ω–∏."),
                ("–î–≤–∞–¥—Ü–∞—Ç—å —Ç—ã—Å—è—á –ª—å–µ –ø–æ–¥ –≤–æ–¥–æ–π", "–ñ—é–ª—å –í–µ—Ä–Ω", "–ü—Ä–∏–∫–ª—é—á–µ–Ω–∏—è", 1870, "–ü–æ–∏—Å–∫ –∑–∞—Ç–µ—Ä—è–Ω–Ω–æ–π —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏."),
                ("–ó–∞–≥–∞–¥–∫–∞ –¢—É–Ω–≥—É—Å—Å–∫–æ–≥–æ –º–µ—Ç–µ–æ—Ä–∏—Ç–∞", "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ö–∞–∑–∞–Ω—Ü–µ–≤", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1964, "–§–∞–Ω—Ç–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–æ–º–∞–Ω –æ–± –∏–Ω–æ–ø–ª–∞–Ω–µ—Ç—è–Ω–∞—Ö."),
                ("–¢—É–º–∞–Ω–Ω–æ—Å—Ç—å –ê–Ω–¥—Ä–æ–º–µ–¥—ã", "–ò–≤–∞–Ω –ï—Ñ—Ä–µ–º–æ–≤", "–ù–∞—É—á–Ω–∞—è —Ñ–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞", 1957, "–ù–∞—É–∫–∞ –∏ –±—É–¥—É—â–µ–µ —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–∞."),
                ("–í–∏—à–Ω–µ–≤—ã–π —Å–∞–¥", "–ê–Ω—Ç–æ–Ω –ß–µ—Ö–æ–≤", "–î—Ä–∞–º–∞", 1904, "–ü—å–µ—Å–∞ –æ –ø—Ä–æ—â–∞–Ω–∏–∏ —Å –ø—Ä–æ—à–ª—ã–º."),
                ("–ù–∞ –¥–Ω–µ", "–ú–∞–∫—Å–∏–º –ì–æ—Ä—å–∫–∏–π", "–î—Ä–∞–º–∞", 1902, "–ò—Å—Ç–æ—Ä–∏—è –æ–± –æ–±–∏—Ç–∞—Ç–µ–ª—è—Ö –Ω–æ—á–ª–µ–∂–∫–∏."),
            ]
            
            books_added = 0
            for title, author_name, genre_name, year, description in books_data:
                if books_added >= 50:
                    break
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ç–∞–∫–∞—è –∫–Ω–∏–≥–∞
                result = await session.execute(
                    select(BooksModel).where(BooksModel.title == title)
                )
                existing = result.scalars().first()
                
                if not existing:
                    author = authors_dict.get(author_name)
                    genre = genres_dict.get(genre_name)
                    
                    if author and genre:
                        book = BooksModel(
                            title=title,
                            description=description,
                            year=year,
                            author_id=author.id,
                            genre_id=genre.id
                        )
                        session.add(book)
                        books_added += 1
                        print(f"  ‚úì –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–∏–≥–∞: {title}")
                    else:
                        print(f"  ‚úó –ü—Ä–æ–ø—É—â–µ–Ω–∞ –∫–Ω–∏–≥–∞ '{title}': –∞–≤—Ç–æ—Ä={author_name if not author else 'OK'}, –∂–∞–Ω—Ä={genre_name if not genre else 'OK'}")
            
            await session.commit()
            print(f"\n‚úÖ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ {books_added} –∫–Ω–∏–≥")
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            print("\nüìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
            result = await session.execute(select(AuthorsModel))
            authors_count = len(result.scalars().all())
            result = await session.execute(select(GengresModel))
            genres_count = len(result.scalars().all())
            result = await session.execute(select(BooksModel))
            books_count = len(result.scalars().all())
            
            print(f"  - –ê–≤—Ç–æ—Ä–æ–≤ –≤ –ë–î: {authors_count}")
            print(f"  - –ñ–∞–Ω—Ä–æ–≤ –≤ –ë–î: {genres_count}")
            print(f"  - –ö–Ω–∏–≥ –≤ –ë–î: {books_count}")
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: {e}")
            await session.rollback()
            raise

if __name__ == "__main__":
    print("="*60)
    print("üöÄ –ù–∞—á–∏–Ω–∞—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (ASYNC)...")
    print("="*60)
    asyncio.run(populate_database())
    print("\n" + "="*60)
    print("‚ú® –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print("="*60)
